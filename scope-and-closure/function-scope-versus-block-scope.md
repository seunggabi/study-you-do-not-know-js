# 함수 vs 블록 스코프
> 스코프는 컨테이너 또는 바구니 구실을 하는 일련의 `버블`이고 변수나 함수 같은 확인자가 그 안에서 선언된다.<br>
> 이 버블은 경계가 분명하게 중첩되고, 그 경계는 프로그래머가 코드를 작성할 때 결정된다.<br>

<br>

### 함수 기반 스코프
> 함수 스코프는 모든 변수가 함수에 속하고 함수 전체(심지어 중첩된 스코프에서도)에 걸쳐 사용되며 재사용된다는 개념을 확고하게 한다.

<br>

### 일반 스코프에 숨기
> 함수를 선언하고 그 안에 코드를 넣는다, 이는 해당 코드를 '숨기는' 효과를 낸다.
- 새로운 스코프 버블이 생성
- 소프트웨어 디자인 원칙인 최소권한의 원칙(최소권위 or 최소노출)과 관련되어 있다.
- 접근할 수 있도록 내버려 두는 것은 불필요할 뿐 아니라 위험!
- 충돌회피: 글로벌 네임스페이스 & 모듈 관리

<br>

### 스코프 역할을 하는 함수
> 스코프를 오염시킨다.
```javascript
var n = 1;

// window 객체 참조를 global이라 이름 붙인 인자에 넘겨서 글로벌 참조와 비글로벌 참조 사이에 명확한 차이를 만들었다.
(function IIFE(global) {
	var n = 2;
	console.log(n);
	console.log(global.n);
})(window);

console.log(n);

// 첫번째 (): 함수를 표현식으로 바꿈.
// 두번째 (): 함수를 실행시킨다.
// 즉시 호출 함수 표현식 (IIFE - Immediately, Invoked, Function, Expression)
```

- 익명 함수
  - 스택 추적 시 표시할 이름이 없어서 디버깅이 어렵다.
  - 이름 없이 재귀 호출을 하려면 불행히도 폐기 예정인, arguments.callee 참조가 필요
  - 이름은 쉽게 이해하고 읽을 수 있는 코드 작성에 도움을 주는데, 이것을 생략한다.
> 따라서 함수 표현식을 사용할 때 이름을 항상 쓰는 것이 가장 좋다.

```javascript
// UMD(Universal Module Definition): 범용 모듈 정의 패턴이다.
var n = 1;

(function IIFE(def){
	
	def(window);
	
})(function def(global){
	var n = 2;
	
	console.log(n);
	console.log(global.n);
});
```
<br>

### 스코프 역할을 하는 블록
- `with`<br>
  `with` 문 안에서 생성된 객체는 바깥 스코프에 영향 주는 일 없이 `with` 문이 끝날때 까지만 존재한다.
- `try ~ catch`
  - `catch` 부분에서 선언된 변수는 catch 블록 스코프에 속한다.
  - `catch` 문이 둘 이상 있을 경우 경고를 보낸다. 사실 이런 선언은 재정의가 아니다.
  - 그 변수들은 안전하게 각기 다른 블록 스코프에 속하기 때문이다.
- `let`
  - `let`은 선언한 변수를 위해 해당 블록 스코프를 이용한다고도 말할 수 있다.
  - 그러나 `let`을 사용한 선언문은 속하는 스코프에서 호이스팅 효과를 받지 않는다.
  - 따라서 `let`으로 선언된 변수는 실제 선언문 전에는 명백하게 ~~존재~~하지 않는다.
- `가비지 콜렉션 (Garbage Collection)`
  - click 함수가 해당 스코프 전체의 클로저를 가지고 있기 때문이다.
  - 명시적으로 블록을 선언하여 변수의 영역을 한정하는 것은 효과적인 코딩 방식이므로 익혀두면 좋다.
```javascript
function process() {
	// code
}

//GC, process 이후, 메모리 해제
{
	let bigData = { ... };
	process(bigData);
}

function smallJob() {
	// code
}
// 이때 bigData는 존재하지 않는다.
smallJob();
```

<br>

### 블록스코프 변수 (let, const)
> 블록스코프 변수를 사용할 때는 수정 전 주의가 필요하다.

> 블록스코프는 var 함수스코프를 완전히 대체할 수 없다.<br>
> 함수스코프와 블록 스코프기술을 같이 사용할 수 있어야 한다.<br>

> 더 읽기 쉽고 유지 보수가 쉬운 코드를 작성하기 위해 두 기술을 적절한 곳에 사용하면 된다!!